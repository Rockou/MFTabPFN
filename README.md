# MFTabPFN
Multi-fidelity tabular prior-data fitted network model

This repository contains the code for MFTabPFN, designed to address accurate prediction and uncertainty quantification for applications using single- or multi-fidelity data. The corresponding datasets for this repository are available at https://doi.org/10.5281/zenodo.16777637.

# Environment and Dependencies
Due to parameter fine-tuning requirements of MFTabPFN, one or more GPUs are required to achieve efficient code execution.

To install MFTabPFN, clone the repository along with its associated datasets and install the required dependencies, including TabPFN, PyTorch, standard machine learning libraries (e.g., scikit-learn), and other supporting libraries. After installing the dependencies, replace the default regressor.py file generated by the TabPFN library in the working environment with the modified version provided in this repository. The default regressor.py does not support direct output of variance information, whereas the modified version enables the model to produce variance estimates, which are critical for quantifying prediction uncertainty in subsequent analyses.


git clone https://github.com/Rockou/MFtabPFN.git

cd MFTabPFN

uv sync

To perform computational fluid dynamics analysis of the DLR-F4 wing-body configuration (turb_DLR_F4.cfg, DLR_F4_mesh1.su2) and the ONERA M6 wing (low-fidelity: inv_ONERAM6_adv_low.cfg, mesh_ONERAM6_inv_FFD.su2; high-fidelity: inv_ONERAM6_adv_high.cfg, mesh_ONERAM6_inv_FFD.su2), the SU2 software should be installed.
# Use and Analysis
The repository provides implementations for high-dimensional representation analysis on single-fidelity data (HDR_OpenML_S.py, HDR_Performance_S.py, HDR_Synthetic_S.py, HDR_VaryDataSize_S.py), uncertainty quantification on single-fidelity data (UQ_Prediction_S.py), pressure coefficient distribution prediction for the DLR-F4 wing-body configuration using multi-fidelity data (CP_DLRF4_Position_M.py, CP_DLRF4_Ratio_M.py), and lift and drag coefficient prediction and uncertainty quantification for the ONERA M6 wing based on active learning using multi-fidelity data (CL_ONERAM6_M.py, CD_ONERAM6_M.py). All files include implementations of MFTabPFN and reference machine learning methods. To perform the corresponding analyses, directly execute the respective files. To visualize the results, run the associated plotting files.

Additionally, several demonstration files with toy examples, including Toy_S.py, Toy_M.py, and Toy_Active.py, are provided to illustrate the application of MFTabPFN to single-fidelity data, multi-fidelity data, and active learning, respectively.
